program: sweep/sweep_runner.py
method: bayes
metric:
  name: all/exact_accuracy
  goal: maximize
parameters:
  lr:
    distribution: log_uniform_values
    min: 1e-4
    max: 1e-3
  weight_decay:
    values: [0.01, 0.05, 0.1]
  muon_lr:
    distribution: log_uniform_values
    min: 1e-3
    max: 5e-3
  muon_weight_decay:
    values: [0.0, 0.01, 0.1]
  puzzle_emb_lr:
    distribution: log_uniform_values
    min: 1e-5
    max: 1e-3
  puzzle_emb_weight_decay:
    values: [0.1, 1.0]
  arch.L_layers:
    values: [1, 2, 3]
  arch.H_cycles:
    values: [1, 3, 5]
  arch.L_cycles:
    values: [4, 6, 8]
  arch:
    values: ["trm", "loop_transformer"]
command:
  - python
  - ${program}
  - ${args}
